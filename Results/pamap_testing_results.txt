MODALITY DETECTION - REAL PAMAP2 DATA
======================================================================

[1/3] Building feature dataset from PAMAP2...
Processing ../PAMAP2_Dataset/Protocol/subject108.dat...
Processing ../PAMAP2_Dataset/Protocol/subject109.dat...
Processing ../PAMAP2_Dataset/Protocol/subject107.dat...
Processing ../PAMAP2_Dataset/Protocol/subject106.dat...
Processing ../PAMAP2_Dataset/Protocol/subject104.dat...
Processing ../PAMAP2_Dataset/Protocol/subject105.dat...
Processing ../PAMAP2_Dataset/Protocol/subject101.dat...
Processing ../PAMAP2_Dataset/Protocol/subject102.dat...
Processing ../PAMAP2_Dataset/Protocol/subject103.dat...

Dataset shape: (145626, 29)
Modalities: ['accelerometer' 'gyroscope' 'magnetometer' 'temperature']
Samples per modality:
modality
accelerometer    67212
gyroscope        33606
magnetometer     33606
temperature      11202
Name: count, dtype: int64

[2/3] Analyzing feature discrimination...
============================================================
FEATURE DISCRIMINATION ANALYSIS
Analyzing 23 features across 4 classes
============================================================

Top 15 Most Discriminative Features:
------------------------------------------------------------
Feature                       F-stat      p-value       η²
------------------------------------------------------------
zcr                         93858.11     0.00e+00    0.659*
rms                         77733.06     0.00e+00    0.616*
adev_0.01s                  74289.96     0.00e+00    0.605*
quantile_25                 33593.67     0.00e+00    0.409*
mean                        32974.99     0.00e+00    0.405*
quantile_50                 32782.09     0.00e+00    0.403*
quantile_75                 31776.12     0.00e+00    0.396*
adev_0.02s                  18696.69     0.00e+00    0.278*
spectral_centroid           14198.42     0.00e+00    0.226*
spectral_flatness           12408.69     0.00e+00    0.204*
psd_slope                   10111.82     0.00e+00    0.000*
adev_0.03s                   9934.74     0.00e+00    0.170*
adev_0.05s                   5466.67     0.00e+00    0.101*
adev_0.08s                   3738.85     0.00e+00    0.072*
adev_slope                   3362.86     0.00e+00    0.000*
------------------------------------------------------------
* = statistically significant (p < 0.05)

Total significant features: 23 / 23

Top 10 discriminative features:
              feature   f_statistic  p_value  eta_squared  cv_between_classes  significant
5                 zcr  93858.112594      0.0     0.659122            1.599788         True
2                 rms  77733.060625      0.0     0.615592            0.931326         True
13         adev_0.01s  74289.960052      0.0     0.604816            1.184006         True
6         quantile_25  33593.673935      0.0     0.409009            2.127948         True
0                mean  32974.987993      0.0     0.404523            2.034678         True
7         quantile_50  32782.088485      0.0     0.403111            2.035772         True
8         quantile_75  31776.117322      0.0     0.395635            1.946837         True
14         adev_0.02s  18696.690363      0.0     0.278070            1.013226         True
12  spectral_centroid  14198.423766      0.0     0.226309            0.604682         True
11  spectral_flatness  12408.694983      0.0     0.203590            0.405815         True

[3/3] Training Random Forest classifier...
============================================================
PROTOTYPE CLASSIFIER
============================================================

Dataset: 145626 samples, 23 features
Classes: ['accelerometer', 'gyroscope', 'magnetometer', 'temperature']

Training Random Forest classifier...
Cross-validation accuracy: 0.992 (+/- 0.001)

========================================
CLASSIFICATION REPORT
========================================
               precision    recall  f1-score   support

accelerometer       0.99      0.99      0.99     13443
    gyroscope       0.98      0.99      0.98      6721
 magnetometer       1.00      1.00      1.00      6721
  temperature       1.00      1.00      1.00      2241

     accuracy                           0.99     29126
    macro avg       0.99      0.99      0.99     29126
 weighted avg       0.99      0.99      0.99     29126


CONFUSION MATRIX
----------------------------------------
               accelerometer  gyroscope  magnetometer  temperature
accelerometer          13275        159             9            0
gyroscope                 77       6644             0            0
magnetometer               7          0          6714            0
temperature                0          0             0         2241

========================================
TOP 10 MOST IMPORTANT FEATURES
========================================
adev_0.01s                0.1794 ████████
rms                       0.1480 ███████
zcr                       0.1157 █████
adev_0.02s                0.0929 ████
adev_0.03s                0.0691 ███
adev_0.05s                0.0498 ██
quantile_25               0.0480 ██
psd_slope                 0.0448 ██
quantile_50               0.0418 ██
quantile_75               0.0389 █

======================================================================
RESULTS SUMMARY
======================================================================
Test Accuracy: 99.13%
Most important feature: adev_0.01s
Most discriminative feature: zcr
======================================================================
FAULT DETECTION - SYNTHETIC DEGRADATION
======================================================================

[1/2] Building fault detection dataset...
Processing ../PAMAP2_Dataset/Protocol/subject108.dat...
Processing ../PAMAP2_Dataset/Protocol/subject109.dat...

Dataset shape: (25866, 28)
Labels: ['healthy' 'degraded']
Samples per label:
label
degraded    21555
healthy      4311
Name: count, dtype: int64
Fault types:
fault_type
none               4311
noise_increase     4311
bias_drift         4311
spike_injection    4311
bandwidth_loss     4311
saturation         4311
Name: count, dtype: int64

[2/2] Training fault detector...
============================================================
PROTOTYPE CLASSIFIER
============================================================

Dataset: 25866 samples, 23 features
Classes: ['degraded', 'healthy']

Training Random Forest classifier...
Cross-validation accuracy: 0.860 (+/- 0.010)

========================================
CLASSIFICATION REPORT
========================================
              precision    recall  f1-score   support

    degraded       0.87      0.98      0.92      4312
     healthy       0.74      0.25      0.37       862

    accuracy                           0.86      5174
   macro avg       0.80      0.61      0.65      5174
weighted avg       0.85      0.86      0.83      5174


CONFUSION MATRIX
----------------------------------------
          degraded  healthy
degraded      4237       75
healthy        649      213

========================================
TOP 10 MOST IMPORTANT FEATURES
========================================
adev_0.01s                0.1555 ███████
adev_0.02s                0.0856 ████
psd_slope                 0.0813 ████
mean                      0.0611 ███
spectral_flatness         0.0586 ██
quantile_50               0.0557 ██
quantile_25               0.0551 ██
quantile_75               0.0530 ██
rms                       0.0502 ██
adev_0.03s                0.0501 ██

======================================================================
RESULTS SUMMARY
======================================================================
Test Accuracy: 86.01%
Most important feature: adev_0.01s